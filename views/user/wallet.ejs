
<%- include("../../views/layout/user/header",{user:user}) %>
 <head>
  <title>
   Wallet Page
  </title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
  <style>
.wallet-page {
    font-family: 'Roboto', sans-serif;
    background-color: #f5f5f5;
    margin: 0;
    padding: 0;
}

/* Ensure the styles are scoped inside .wallet-page */
.wallet-page .container2 {
    display: flex;
    padding: 20px;
}

/* Sidebar styling */
.wallet-page .sidebar2 {
    width: 250px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-right: 20px;
    padding: 20px;
    height:500px
}

/* Profile inside the sidebar */
.wallet-page .sidebar2 .profile {
    background-color: #3f51b5;
    color: #ffffff;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    margin-bottom: 20px;
}

/* List items in sidebar */
.wallet-page .sidebar2 ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.wallet-page .sidebar2 ul li {
    margin-bottom: 10px;
}

.wallet-page .sidebar2 ul li a {
    text-decoration: none;
    color: #333;
    display: flex;
    align-items: center;
    padding: 10px;
    border-radius: 4px;
    transition: background-color 0.3s;
}

/* Sidebar active item */
.wallet-page .sidebar2 ul li a:hover, 
.wallet-page .sidebar2 ul li a.active {
    background-color: #e0e0e0;
}

/* Content styling */
.wallet-page .content {
    flex: 1;
}

/* Balance box styling */
.wallet-page .content .balance,
.wallet-page .content .transactions,
.wallet-page .content .note {
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin-bottom: 20px;
}

/* Header for balance and transaction sections */
.wallet-page .content .balance h3,
.wallet-page .content .transactions h3 {
    margin: 0 0 20px;
    font-size: 18px;
    font-weight: 500;
}

/* Balance amount styling */
.wallet-page .content .balance .amount {
    font-size: 36px;
    font-weight: 700;
    margin: 0;
}

/* Description under balance */
.wallet-page .content .balance .description {
    font-size: 14px;
    color: #666;
    margin: 10px 0;
}

/* Actions under balance section */
.wallet-page .content .balance .actions {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
}

/* Individual action buttons */
.wallet-page .content .balance .actions .action {
    text-align: center;
    flex: 1;
    margin: 0 5px;
}

.wallet-page .content .balance .actions .action img {
    width: 40px;
    height: 40px;
    margin-bottom: 10px;
}

.wallet-page .content .balance .actions .action p {
    margin: 0;
    font-size: 14px;
}

/* Gift card button */
.wallet-page .content .balance .add-gift-card {
    text-align: center;
    margin-top: 20px;
}

.wallet-page .content .balance .add-gift-card a {
    color: #4b4bb5;
    text-decoration: none;
    font-weight: 500;
}

/* Transactions section */
.wallet-page .content .transactions .no-transactions {
    text-align: center;
    color: #666;
}

.wallet-page .content .transactions .no-transactions img {
    width: 100px;
    height: 100px;
    margin-bottom: 10px;
}

/* Note section styling */
.wallet-page .content .note h4 {
    margin: 0 0 10px;
    font-size: 16px;
    font-weight: 500;
}

.wallet-page .content .note ul {
    list-style: none;
}


/*for transaction*/
.transactions {
        width: 100%;
        max-width: 500px;
        margin: 20px auto;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        text-align: center;
    }

    /* Heading */
    .transactions h3 {
        font-size: 24px;
        color: #333;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        margin-bottom: 20px;
        border-bottom: 2px solid #007bff;
        padding-bottom: 10px;
        text-align: center;
    }

    /* Transaction list and items */
    .transaction-list {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }

    .transaction-item {
        display: flex;
        justify-content: space-between;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
        background-color: #ffffff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* Different styles for credit and debit transactions */
    .transaction-item.credit {
        border-left: 4px solid #28a745; /* Green for credit */
    }

    .transaction-item.debit {
        border-left: 4px solid #dc3545; /* Red for debit */
    }

    /* Date styling */
    .transaction-date {
        font-size: 14px;
        color: #666;
        font-style: italic;
    }

    /* Description styling */
    .transaction-description {
        font-size: 16px;
        color: #333;
        font-weight: bold;
    }

    /* Amount styling */
    .transaction-amount {
        font-size: 18px;
        font-weight: bold;
    }

    .transaction-item.credit .transaction-amount {
        color: #28a745; /* Green for credit */
    }

    .transaction-item.debit .transaction-amount {
        color: #dc3545; /* Red for debit */
    }

    /* Status styling */
    .transaction-status {
        font-size: 14px;
        color: #888;
        text-transform: capitalize;
    }

    /* No transactions message */
    .no-transactions {
        text-align: center;
        color: #888;
        font-size: 16px;
    }


    /*for button add to money*/
    .add-money-to-wallet {
        text-align: center;
        margin-top: 20px;
    }

    /* Button styling */
    .add-money-to-wallet button {
        background-color: #007bff; /* Blue background */
        color: #ffffff; /* White text */
        font-size: 16px;
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease; /* Smooth transition for hover and focus */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow effect */
    }

    /* Hover effect */
    .add-money-to-wallet button:hover {
        background-color: #0056b3; /* Darker blue on hover */
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
    }

    /* Focus effect */
    .add-money-to-wallet button:focus {
        outline: none; /* Remove default outline */
        box-shadow: 0 0 8px rgba(0, 123, 255, 0.6); /* Blue outline when focused */
    }

    /* Active effect (when the button is pressed) */
    .add-money-to-wallet button:active {
        background-color: #004085; /* Even darker blue on click */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Reduced shadow on click */
    }

    /*for cash*/
    .amount {
        font-size: 30px;
        color: #28a745; /* Green color for a positive, wallet-like feel */
        font-weight: 700; /* Bold the amount for emphasis */
        margin-top: 10px;
        letter-spacing: 1px; /* Add some spacing between digits for clarity */
        text-align: center; /* Center-align the text */
        padding: 10px;
        border-radius: 8px; /* Slightly rounded corners for a modern feel */
        background-color: #f0f9f1; /* Light green background, subtle and clean */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow to make it stand out */
        display: inline-block; /* Make it inline for better control */
        transition: all 0.3s ease; /* Smooth transition for hover effect */
    }

    .amount:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* Slightly deeper shadow on hover */
        transform: translateY(-3px); /* Lift effect on hover */
    }

    /*for boxes*/
    .actions {
        display: flex;
        justify-content: space-between;
        margin: 20px 0;
        gap: 20px;
    }

    .action {
        background-color: #ffffff;
        border: none;
        border-radius: 12px;
        padding: 15px 25px;
        text-align: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        width: 160px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .action img {
        width: 40px;
        height: 40px;
        margin-bottom: 10px;
        transition: transform 0.3s ease;
    }

    .action p {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        margin-top: 5px;
        transition: color 0.3s ease;
    }

    .action:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
    }

    .action:hover img {
        transform: scale(1.1);
    }

    .action:hover p {
        color: #007bff; /* Change text color on hover */
    }

    /* Optional: Add specific colors for different buttons */
    .action:nth-child(1):hover {
        background-color: #28a745;
        color: #ffffff;
    }

    .action:nth-child(2):hover {
        background-color: #ffc107;
        color: #ffffff;
    }

    .action:nth-child(3):hover {
        background-color: #dc3545;
        color: #ffffff;
    }

    /* Pagination Container */
.pagination-nav {
    display: flex;
    flex-wrap: wrap; /* Allow wrapping on smaller screens */
    justify-content: center; /* Center align */
    gap: 10px; /* Space between elements */
    margin: 20px 0;
    padding: 10px 0;
}

/* Pagination Links */
.pagination-link {
    display: inline-block;
    padding: 10px 15px;
    text-decoration: none;
    color: #007bff;
    border: 1px solid #ddd;
    border-radius: 5px;
    transition: all 0.3s ease;
    font-size: 0.9em;
}

/* Active Page Styling */
.pagination-link.active {
    background-color: #007bff;
    color: #fff;
    border-color: #007bff;
    font-weight: bold;
}

/* Hover Effect */
.pagination-link:hover {
    background-color: #f0f0f0;
    color: #0056b3;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .pagination-link {
        font-size: 0.8em; /* Smaller text size */
        padding: 8px 12px; /* Adjust padding */
    }
}

@media (max-width: 480px) {
    .pagination-nav {
        flex-direction: column; /* Stack links vertically */
        align-items: center; /* Center align vertically stacked links */
    }
    .pagination-link {
        width: 100%; /* Full width for better tap targets */
        text-align: center;
    }
}


  </style>
 </head>
 <body class="wallet-page">
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Section -->
            <div class="col-md-3 col-sm-12">
                <div class="sidebar2">
                    <div class="profile">
                        <h2><%= user.username %></h2> <!-- Dynamic name from user -->
                        <p><%= user.email %></p> <!-- Dynamic phone number from user -->
                    </div>
                    <ul>
                        <li><a href="#">Orders &amp; Returns</a></li>
                        <li><a href="/myOrders">My Profile</a></li>
                        <li class="active"><a href="/wallet">Wallet <span>₹ <%= wallet.balance %></span></a></li>
                        <li><a href="#">Sporty Rewards</a></li>
                        <li><a href="/address">Address</a></li>
                        <li><a href="#">Logout</a></li>
                    </ul>
                </div>
            </div>

            <!-- Content Section -->
            <div class="col-md-9 col-sm-12">
                <div class="content">
                    <!-- Balance Section -->
                    <form action="/wallet" method="post">
                        <div class="balance">
                            <h3>Cash Balance</h3>
                            <p class="amount">₹ <%= wallet.balance %></p>
                            <p class="description">GiftCard top-ups and Refunds</p>

                            <div class="actions row">
                                <div class="col-md-4 col-sm-12">
                                    <button type="button" name="action" value="quick_checkout" class="action">
                                        <img alt="Quick Checkout" src="https://storage.googleapis.com/a1aa/image/bSXxAnnfJen9OkHMuXIabO6xoZhXbcqle4bEMcheZTvPlOedC.jpg" />
                                        <p>Quick Checkout</p>
                                    </button>
                                </div>
                                <div class="col-md-4 col-sm-12">
                                    <button type="button" name="action" value="consolidated_money" class="action">
                                        <img alt="Consolidated Money" src="https://storage.googleapis.com/a1aa/image/kKfCG8deIYqXJkOCHqHggDmb5efoa7YKMRkv4frPJmKMKd8dC.jpg" />
                                        <p>Consolidated Money</p>
                                    </button>
                                </div>
                                <div class="col-md-4 col-sm-12">
                                    <button type="button" name="action" value="instant_refund" class="action">
                                        <img alt="Instant Refund" src="https://storage.googleapis.com/a1aa/image/DT4H3XvfOeif0oKY8zSim1Sr6XiujMnLzgFqWJ9thNplSHfOB.jpg" />
                                        <p>Instant Refund</p>
                                    </button>
                                </div>
                            </div>

                            <div class="add-money-to-wallet mt-3">
                                <button type="button" onclick="showAddFundsModal()">ADD MONEY TO WALLET</button>
                            </div>
                        </div>
                    </form>

                    <!-- Transactions Section -->
                    <div class="transactions">
                        <h3>Transactions</h3>
                        <% if (wallet.transaction && wallet.transaction.length > 0) { %>
                            <ul class="transaction-list">
                                <% wallet.transaction.forEach(transaction => { %>
                                    <li class="transaction-item <%= transaction.transactionType %>">
                                        <span class="transaction-date">
                                            <%= transaction.date ? new Date(transaction.date).toLocaleDateString() : 'Date not available' %>
                                        </span>
                                        <span class="transaction-description">
                                            <% if (transaction.transactionType === 'credit') { %>
                                                Money Added
                                            <% } else if (transaction.transactionType === 'debit') { %>
                                                Money Debited
                                            <% } else { %>
                                                Unknown Transaction
                                            <% } %>
                                        </span>
                                        <span class="transaction-amount">
                                            <%= transaction.transactionType === 'credit' ? '+' : '-' %>₹ <%= transaction.amount %>
                                        </span>
                                        <span class="transaction-status"><%= transaction.status %></span>
                                    </li>
                                <% }) %>
                            </ul>
                        <% } else { %>
                            <div class="no-transactions">
                                <img alt="No Transactions" src="https://storage.googleapis.com/a1aa/image/wSfIN9SbtjWgP6eFwU2AmH7GKbyuckWevQtE0UiCyt3fkOedC.jpg" />
                                <p>No transactions yet!<br />Add a gift card for faster checkout.</p>
                            </div>
                        <% } %>
                    </div>

                    <!-- Notes Section -->
                    <div class="note">
                        <h4>Please Note</h4>
                        <ul>
                            <li>The Amount added in the Wallet cannot be transferred to any other user's Wallet or Bank Account.</li>
                            <li>The amount in the Wallet cannot be withdrawn in the form of cash.</li>
                            <li>The amount in Wallet can be utilized only to purchase products online and in-store.</li>
                            <li>Any amount added to the wallet through Gift Card has an expiry of 1 year from the date of purchase.</li>
                            <li>Any amount added to Gift Card upon return of an item will follow the respective policy.</li>
                        </ul>
                    </div>

                    <!-- Pagination Section -->
                    <div class="pagination-nav">
                        <!-- Pagination links here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        function showAddFundsModal() {
            Swal.fire({
                title: 'Add Funds to Wallet',
                input: 'number',
                inputLabel: 'Amount (₹)',
                inputPlaceholder: 'Enter amount',
                inputAttributes: {
                    min: 0,
                    step: 0.01
                },
                showCancelButton: true,
                confirmButtonText: 'Add Funds',
                cancelButtonText: 'Cancel',
                showLoaderOnConfirm: true,
                preConfirm: (amount) => {
                    
                    if (amount <= 0) {
                        Swal.showValidationMessage('Please enter a valid amount');
                        return false;
                    }
    
                    
                    return fetch('/addWallet', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            amount: parseFloat(amount),
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            return data; 
                        } else {
                            throw new Error('Failed to add funds');
                        }
                    })
                    .catch(error => {
                        Swal.showValidationMessage(error.message); 
                    });
                },
                allowOutsideClick: () => !Swal.isLoading()
            }).then((result) => {
                if (result.isConfirmed) {
                    
                    Swal.fire(
                        'Success!',
                        `₹ ${result.value.balance} added to your wallet.`,
                        'success'
                    );
    
                
                    document.querySelector('.amount').textContent = `₹ ${result.value.balance}`;
                }
            });
        }
    </script>
  <%- include("../../views/layout/user/footer") %>
